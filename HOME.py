import streamlit as st
from utils.config import load_config  # 설정 로드 함수

# 페이지 설정
st.set_page_config(page_title="OCR 시스템 홈", page_icon="🏠", layout="wide")

# 페이지 제목
st.title("🏠 OCR 시스템 홈")

# 설정 로드
ui_config = load_config("ui")  # UI 관련 설정 로드

# 자동 리다이렉트 설정 확인
if ui_config.get("auto_redirect_to_detection", False):
    # 감지 페이지로 리다이렉트
    st.experimental_set_query_params(
        page=ui_config.get("detection_page_path", "감지실행")
    )
    st.info("자동으로 감지 페이지로 이동 중입니다...")
else:
    # 기본 홈 화면 메시지
    st.markdown("### 👋 환영합니다! OCR 시스템에 오신 것을 환영합니다.")
    st.markdown("왼쪽 사이드바에서 원하는 페이지를 선택하세요.")

    st.markdown(
        """
    ## 📌 주요 기능 및 사용 가이드
    
    ### 1️⃣ 감지 실행 
    - **실시간 웹캠 감지**: 연결된 카메라를 통해 실시간으로 숫자를 감지합니다.
    - **이미지 파일 감지**: 업로드한 이미지에서 숫자를 감지합니다.
    - **감지 결과 표시**: 감지된 숫자를 설정된 방향에 따라 정렬하여 보여줍니다.
    - **확대/축소 기능**: 결과 이미지의 크기를 조절할 수 있습니다.
    
    ### 2️⃣ 모델 학습
    - **데이터셋 준비**: 학습에 사용할 이미지와 라벨링 데이터를 준비합니다.
    - **학습 설정**: 모델 크기, 에폭 수, 배치 크기 등 상세 설정이 가능합니다.
    - **학습 모니터링**: 실시간으로 학습 진행 상황과 성능 지표를 확인합니다.
    - **결과 분석**: 학습 완료 후 성능 그래프와 혼동 행렬을 통해 결과를 분석합니다.
    
    ### 3️⃣ ROI 설정
    - **관심 영역 설정**: 마우스로 드래그하여 감지할 영역을 지정합니다.
    - **다중 영역 관리**: 여러 개의 ROI를 추가/삭제할 수 있습니다.
    - **실시간 미리보기**: 설정한 ROI를 실시간으로 확인할 수 있습니다.
    - **설정 저장**: 지정한 ROI 설정을 저장하여 재사용할 수 있습니다.
    
    ### 4️⃣ PLC 설정
    - **통신 설정**: PLC와의 통신을 위한 IP 주소, 포트 등을 설정합니다.
    - **데이터 매핑**: 감지 결과를 PLC 메모리 주소에 매핑합니다.
    - **통신 테스트**: PLC 연결 상태를 테스트할 수 있습니다.
    
    ### 5️⃣ 환경 설정
    - **감지 설정**: 신뢰도 임계값, IoU, NMS 등 감지 관련 설정을 조정합니다.
    - **카메라 설정**: 해상도, 프레임 레이트 등 카메라 관련 설정을 조정합니다.
    - **UI 설정**: 자동 시작, 결과 표시 방식 등 UI 관련 설정을 조정합니다.
    
    ## 💡 시작하기
    1. 환경 설정에서 기본 설정을 확인하고 필요에 따라 조정하세요.
    2. ROI 설정에서 감지할 영역을 지정하세요.
    3. PLC 설정이 필요한 경우 통신 설정을 완료하세요.
    4. 감지 실행 페이지에서 실시간 감지를 시작하세요.
    
    ## ❓ 도움말
    각 페이지의 설정 항목에 마우스를 올리면 상세 설명을 확인할 수 있습니다.
    """
    )
